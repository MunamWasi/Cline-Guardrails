We built a minimal guardrails layer for the Cline coding agent that blocks risky tool actions before they run. The hook integrates with TryMightyAI Citadel running locally as an HTTP sidecar (`citadel serve`) and scans tool payloads for security risks. It enforces a simple, demo-friendly policy: ALLOW, WARN, or BLOCK with a short reason. To keep the demo resilient, we added a small regex hard-block fallback that triggers even if Citadel is down or misconfigured (secrets like `AKIA...`, `ghp_...`, and `sk-...`, plus command footguns like `curl | sh`, `rm -rf /`, and `chmod 777`). If you have a Mighty API key, the same hook can optionally call the hosted Gateway `/v1/scan` for stronger models. In the demo we show two dangerous tool invocations getting cancelled and a benign write passing through. The result is a shippable, bash-first guardrail that can be dropped into Cline with minimal setup, no heavy dependencies, and clear PASS/FAIL behavior.
